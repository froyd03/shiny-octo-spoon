<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <nav>
        <div class="nav-header">
            <img src="../../assets/SMDS-logo-only.png" width='80px'/>
        </div>   
            <a href="">
                <div style="background-color:#4A5878; color: white;" class='navBtn'>
                    <img src="../../assets/home-agreement.png" width='20px' height='20px' alt="error">
                    <span>Dashboard</span>
                </div>
            </a>
            <a href="../expenses/expenses.html">
                <div class='navBtn'>
                    <img src="../../assets/expenses.png" width='25px' height='25px' alt="error">
                    <span>Expenses</span>
                </div>
            </a>
            <a href="../reports/report.html">
                <div class='navBtn'>
                    <img src="../../assets/file.png" width='23px' height='23px' alt="error">
                    <span>Reports</span>
                </div>
            </a>
            <a href="../payment/payments.html">
                <div class='navBtn'>
                    <span>Payment</span>
                </div>
            </a>
    </nav>
    <section>
        <h2>Homeowner Management</h2>
        <div class="overview">
            <div class="layout">
                <h3>Overview</h3>
                <div class="overview-item">
                    <div class="item">
                        <p>Number of homeowners</p>
                        <div class='sales'>
                            <img width='30px' alt='error' height='30px'/>
                            <h4>0</h4>
                        </div>
                    </div>
                    <span class="vl"></span>
                    <div class="item">
                        <p>Total Expenses</p>
                        <div class='sales'>
                            <img width='30px' alt='error' height='30px'/>
                            <h4>₱ 00.00</h4>
                        </div>
                    </div>
                    <span class="vl"></span>
                    <div class="item">
                        <p>Total Income</p>
                        <div class='sales'>
                            <img width='30px' alt='error' height='30px'/>
                            <h4>₱ 00.00</h4>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal" style="display: none;">
            <form id="modalForm">
                <h3>New Homeowner</h3>
                <label for="lastName">Last name</label>
                <input type="text" id="lastName" required><br>
    
                <label for="middleName">Middle name (optional)</label>
                <input type="text" id="middleName"><br>
    
                <label for="firstName">First name</label>
                <input type="text" id="firstName"><br>
                
                <label for="contactInfo">Contact Information</label>
                <input type="text" id="contactInfo" placeholder="Phone number or Email address" required><br>
                
                <label for="address">Address</label>
                <input type="text" id="address" placeholder="House/Lot number, Street" required><br>
                
                <div class="selection">
                    <label for="method">Payment Method:
                        <select id="paymentMethod">
                            <option value="Cash">Cash</option>
                            <option value="Gcash">Gcash</option>
                            <option value="Maya">Maya</option>
                            <option value="Paypal">Paypal</option>
                        </select>
                    </label>
                    <label for="method">Payment Status:
                        <select id="paymentStatus">
                            <option value="Paid">Paid</option>
                            <option value="Pending">Pending</option>
                        </select>
                    </label>
                </div>
                <button type="submit">Add Homeowner</button>
                <button class="cancel">Discard</button>
            </form>
        </div>
        <div class="homeownerList">
            <div class="headerTblList">
                <h3>Homeowners List</h3>
                <input type="text" class="searchInp" placeholder="Search here">
                <div class="btn">
                    <button id="newHomeowner"> New</button>
                    <button class="filter">filter</button>
                </div>
            </div>
            <table id="homeownersTable">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Contact</th>
                        <th>Address</th>
                        <th>Payment Method</th>
                        <th>Payment Status</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody id="homeownersTableBody">
                </tbody>
            </table>
        </div>
    </section>
    <script>
    
    let homeowner = [
        { name: "John Doe", contact: "01122334455", address: "blk10 lot18 Rose st.", method: "Cash", status: "Paid" },
        { name: "Linda inday", contact: "09988776655", address: "blk12 lot8 Sampaguita st.", method: "Maya", status: "Paid" },
        { name: "Marites Robert", contact: "09123456789", address: "blk15 lot12 Gumamela st.", method: "Gcash", status: "Pending" },
        { name: "Chinggoy Estrada", contact: "09214354658", address: "blk2 lot5 Rose st.", method: "Paypal", status: "paid" },
        { name: "Imelda Marcos", contact: "05155232543", address: "blk9 lot22 Santan st.", method: "Cash", status: "Pending" }
    ];

    document.addEventListener("DOMContentLoaded", function () {
        const searchInput = document.querySelector(".searchInp");
        const tableRows = document.querySelectorAll("#homeownersTable tbody tr");

        searchInput.addEventListener("keyup", function () {
            const searchTerm = searchInput.value.toLowerCase();

            document.querySelectorAll("#homeownersTableBody tr").forEach(row => {
                row.style.display = row.textContent.toLowerCase().includes(searchTerm) ? "" : "none";
            });
        });

        const form = document.getElementById("modalForm");
        const tableBody = document.getElementById("homeownersTableBody");
  
        homeowner.forEach((value, index) => {
            const row = document.createElement("tr");
            row.innerHTML += `
                <td>${value.name}</td>
                <td>${value.contact}</td>
                <td>${value.address}</td>
                <td>${value.method}</td>
                <td>${value.status}</td>
                <td class="actions">
                    <button class="edit-btn"> Edit</button>
                    <button class="delete-btn"> Delete</button>
                </td>
            `;
            tableBody.appendChild(row);

            // Attach event listeners
            row.querySelector(".edit-btn").addEventListener("click", function () {
                editHomeowner(row);
            });

            row.querySelector(".delete-btn").addEventListener("click", function () {
                deleteHomeowner(row);
            });
        });
    
        const modal = document.querySelector('.modal')
        const newHomeowner = document.querySelector('#newHomeowner');

        const cancelBtn = document.querySelector('.cancel');
        cancelBtn.addEventListener('click', () => {
            modal.style.display = "none";
        });

        newHomeowner.addEventListener('click', () => {
            modal.style.display = "flex";
        });

        form.addEventListener("submit", function (e) {
            e.preventDefault(); // Prevent form submission

            const lastName = document.getElementById("lastName").value.trim();
            const middleName = document.getElementById("middleName").value.trim();
            const firstName = document.getElementById("firstName").value.trim();
            const contact = document.getElementById("contactInfo").value.trim();
            const address = document.getElementById("address").value.trim();
            const paymentMethod = document.getElementById("paymentMethod").value;
            const paymentStatus = document.getElementById("paymentStatus").value;

            if (!firstName || !lastName || !contact || !address) {
                alert("Please fill in all required fields.");
                return;
            }

            const fullName = `${firstName} ${middleName ? middleName + " " : ""}${lastName}`;

            addHomeowner(fullName, contact, address, paymentMethod, paymentStatus);
            form.reset(); // Clear form after adding
        });

        function addHomeowner(name, contact, address, paymentMethod, paymentStatus) {
            const row = document.createElement("tr");

            row.innerHTML = `
                <td>${name}</td>
                <td>${contact}</td>
                <td>${address}</td>
                <td>${paymentMethod}</td>
                <td>${paymentStatus}</td>
                <td class="actions">
                    <button class="edit-btn"> Edit</button>
                    <button class="delete-btn"> Delete</button>
                </td>
            `;

            tableBody.appendChild(row);

            // Attach event listeners
            row.querySelector(".edit-btn").addEventListener("click", function () {
                editHomeowner(row);
            });

            row.querySelector(".delete-btn").addEventListener("click", function () {
                deleteHomeowner(row);
            });

            modal.style.display = "none";
        }

        function editHomeowner(row) {
            const cells = row.getElementsByTagName("td");
            const fullName = cells[0].textContent.trim().split(" ");
            const middleName = fullName.length > 2 ? fullName.slice(1, -1).join(" ") : "";

            document.getElementById("firstName").value = cells[0].textContent.split(" ")[0];
            document.getElementById("middleName").value = middleName;
            document.getElementById("lastName").value = cells[0].textContent.split(" ").slice(-1)[0];
            document.getElementById("contactInfo").value = cells[1].textContent;
            document.getElementById("address").value = cells[2].textContent;
            document.getElementById("paymentMethod").value = cells[3].textContent;
            document.getElementById("paymentStatus").value = cells[4].textContent;

            row.remove();
            modal.style.display = "flex";
            console.log(row);
        }
    });

    function deleteHomeowner(row) {
        if (confirm("Are you sure you want to delete this homeowner?")) {
            row.remove();
        }
    }

    </script>
    
</body>
</html>